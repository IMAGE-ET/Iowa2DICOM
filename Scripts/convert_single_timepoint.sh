
# Step 1: calculate SUVbw factor, save SUV corrected image and RWVM object
##~/local/builds/Slicer-SUVFactorCalculator/lib/Slicer-4.3/cli-modules/SUVFactorCalculator \
##  --SUVbw Derived/suvbw.nrrd --petDICOMPath PET --rwvmDICOMPath SUVbw --returnparameterfile Derived/suv.txt

# Step 2: Find all label values in 'tumor' label, as these will be
# case-specific (use SimpleITK)

# Step 3: calculate quantitative indices for each of the regions
#  For tumor, do it separately for each label found
for region in 'tumor' 'aorta_resampled' 'liver' 'cerebellum'
do
~/local/builds/Slicer-QuantitativeIndicesExt/lib/Slicer-4.3/cli-modules/QuantitativeIndicesCLI \
  --peak --sambg --sam --q4 --q3 --q2 --q1 --gly4 --gly3 --gly2 --gly1 --tlg --quart3 --median \
  --quart1 --volume --rms --max --min --variance --mean \
  --returnparameterfile Derived/${region}.txt --adj Derived/suvbw.nrrd Regions/${region}.nrrd 1
done

# Step 4: encode each of the segmentations in DICOM
# EncodeSEG // work in progress

# Step 5: encode SR - work in progress
EncodeMeasurementsSR --petFiles PET/0.dcm,PET/1.dcm,PET/10.dcm,PET/100.dcm,PET/101.dcm,PET/102.dcm,PET/103.dcm,PET/104.dcm,PET/105.dcm,PET/106.dcm,PET/107.dcm,PET/108.dcm,PET/109.dcm,PET/11.dcm,PET/110.dcm,PET/111.dcm,PET/112.dcm,PET/113.dcm,PET/114.dcm,PET/115.dcm,PET/116.dcm,PET/117.dcm,PET/118.dcm,PET/119.dcm,PET/12.dcm,PET/120.dcm,PET/121.dcm,PET/122.dcm,PET/123.dcm,PET/124.dcm,PET/125.dcm,PET/126.dcm,PET/127.dcm,PET/128.dcm,PET/129.dcm,PET/13.dcm,PET/130.dcm,PET/131.dcm,PET/132.dcm,PET/133.dcm,PET/134.dcm,PET/135.dcm,PET/136.dcm,PET/137.dcm,PET/138.dcm,PET/139.dcm,PET/14.dcm,PET/140.dcm,PET/141.dcm,PET/142.dcm,PET/143.dcm,PET/144.dcm,PET/145.dcm,PET/146.dcm,PET/147.dcm,PET/148.dcm,PET/149.dcm,PET/15.dcm,PET/150.dcm,PET/151.dcm,PET/152.dcm,PET/153.dcm,PET/154.dcm,PET/155.dcm,PET/156.dcm,PET/157.dcm,PET/158.dcm,PET/159.dcm,PET/16.dcm,PET/160.dcm,PET/161.dcm,PET/162.dcm,PET/163.dcm,PET/164.dcm,PET/165.dcm,PET/166.dcm,PET/167.dcm,PET/168.dcm,PET/169.dcm,PET/17.dcm,PET/170.dcm,PET/171.dcm,PET/172.dcm,PET/173.dcm,PET/174.dcm,PET/175.dcm,PET/176.dcm,PET/177.dcm,PET/178.dcm,PET/179.dcm,PET/18.dcm,PET/180.dcm,PET/181.dcm,PET/182.dcm,PET/183.dcm,PET/184.dcm,PET/185.dcm,PET/186.dcm,PET/187.dcm,PET/188.dcm,PET/189.dcm,PET/19.dcm,PET/190.dcm,PET/191.dcm,PET/192.dcm,PET/193.dcm,PET/194.dcm,PET/195.dcm,PET/196.dcm,PET/197.dcm,PET/198.dcm,PET/199.dcm,PET/2.dcm,PET/20.dcm,PET/200.dcm,PET/201.dcm,PET/202.dcm,PET/203.dcm,PET/204.dcm,PET/205.dcm,PET/206.dcm,PET/207.dcm,PET/208.dcm,PET/209.dcm,PET/21.dcm,PET/210.dcm,PET/211.dcm,PET/212.dcm,PET/213.dcm,PET/214.dcm,PET/215.dcm,PET/216.dcm,PET/217.dcm,PET/218.dcm,PET/219.dcm,PET/22.dcm,PET/220.dcm,PET/221.dcm,PET/222.dcm,PET/223.dcm,PET/224.dcm,PET/225.dcm,PET/226.dcm,PET/227.dcm,PET/228.dcm,PET/229.dcm,PET/23.dcm,PET/230.dcm,PET/231.dcm,PET/232.dcm,PET/233.dcm,PET/234.dcm,PET/235.dcm,PET/236.dcm,PET/237.dcm,PET/238.dcm,PET/239.dcm,PET/24.dcm,PET/240.dcm,PET/241.dcm,PET/242.dcm,PET/243.dcm,PET/244.dcm,PET/245.dcm,PET/246.dcm,PET/247.dcm,PET/248.dcm,PET/249.dcm,PET/25.dcm,PET/250.dcm,PET/251.dcm,PET/252.dcm,PET/253.dcm,PET/254.dcm,PET/255.dcm,PET/256.dcm,PET/257.dcm,PET/258.dcm,PET/259.dcm,PET/26.dcm,PET/260.dcm,PET/261.dcm,PET/262.dcm,PET/263.dcm,PET/264.dcm,PET/265.dcm,PET/266.dcm,PET/267.dcm,PET/268.dcm,PET/269.dcm,PET/27.dcm,PET/270.dcm,PET/271.dcm,PET/272.dcm,PET/273.dcm,PET/274.dcm,PET/275.dcm,PET/276.dcm,PET/277.dcm,PET/278.dcm,PET/279.dcm,PET/28.dcm,PET/280.dcm,PET/281.dcm,PET/282.dcm,PET/283.dcm,PET/284.dcm,PET/285.dcm,PET/286.dcm,PET/287.dcm,PET/288.dcm,PET/289.dcm,PET/29.dcm,PET/290.dcm,PET/291.dcm,PET/292.dcm,PET/293.dcm,PET/294.dcm,PET/295.dcm,PET/296.dcm,PET/297.dcm,PET/298.dcm,PET/3.dcm,PET/30.dcm,PET/31.dcm,PET/32.dcm,PET/33.dcm,PET/34.dcm,PET/35.dcm,PET/36.dcm,PET/37.dcm,PET/38.dcm,PET/39.dcm,PET/4.dcm,PET/40.dcm,PET/41.dcm,PET/42.dcm,PET/43.dcm,PET/44.dcm,PET/45.dcm,PET/46.dcm,PET/47.dcm,PET/48.dcm,PET/49.dcm,PET/5.dcm,PET/50.dcm,PET/51.dcm,PET/52.dcm,PET/53.dcm,PET/54.dcm,PET/55.dcm,PET/56.dcm,PET/57.dcm,PET/58.dcm,PET/59.dcm,PET/6.dcm,PET/60.dcm,PET/61.dcm,PET/62.dcm,PET/63.dcm,PET/64.dcm,PET/65.dcm,PET/66.dcm,PET/67.dcm,PET/68.dcm,PET/69.dcm,PET/7.dcm,PET/70.dcm,PET/71.dcm,PET/72.dcm,PET/73.dcm,PET/74.dcm,PET/75.dcm,PET/76.dcm,PET/77.dcm,PET/78.dcm,PET/79.dcm,PET/8.dcm,PET/80.dcm,PET/81.dcm,PET/82.dcm,PET/83.dcm,PET/84.dcm,PET/85.dcm,PET/86.dcm,PET/87.dcm,PET/88.dcm,PET/89.dcm,PET/9.dcm,PET/90.dcm,PET/91.dcm,PET/92.dcm,PET/93.dcm,PET/94.dcm,PET/95.dcm,PET/96.dcm,PET/97.dcm,PET/98.dcm,PET/99.dcm --segFile dummy_seg.dcm --rwvmFile Derived/1.2.276.0.7230010.3.1.4.0.64501.1399048571.637750.dcm --measurementFiles Derived/aorta.txt,Derived/cerebellum.txt,Derived/liver.txt,Derived/tumor.txt  --quantityTerms /Users/fedorov/github/Iowa2DICOM/Resources/QuantitiesAndUnits.csv --srFile sr.dcm
